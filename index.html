<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Vẽ & Tính Toán Hình Khối 3D</title>
  <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
  <style>
    body {
      font-family: Arial;
      margin: 20px;
    }
    canvas {
      display: block;
      width: 100%;
      height: 300px;
      border: 1px solid #ccc;
      margin-top: 10px;
    }
    .inputs {
      margin-top: 10px;
    }
    .inputs input {
      margin: 5px;
    }
  </style>
</head>
<body>
  <h1>Vẽ & Tính Toán Hình Khối 3D</h1>

  <label for="shape">Chọn hình:</label>
  <select id="shape" onchange="updateForm()">
    <option value="">--Chọn--</option>
    <option value="cylinder">Hình trụ</option>
    <option value="cube">Hình lập phương</option>
    <option value="sphere">Hình cầu</option>
  </select>

  <div class="inputs" id="inputs"></div>

  <button onclick="draw()">Vẽ hình</button>
  <button onclick="calculate()">Tính toán</button>

  <div id="output"></div>
  <canvas id="canvas3d"></canvas>

  <script>
    let scene, camera, renderer, mesh;

    function updateForm() {
      const shape = document.getElementById('shape').value;
      const inputsDiv = document.getElementById('inputs');
      inputsDiv.innerHTML = '';
      if (shape === 'cylinder') {
        inputsDiv.innerHTML = `
          <label>Bán kính:</label><input id="r" type="number" /><br/>
          <label>Chiều cao:</label><input id="h" type="number" /><br/>
        `;
      } else if (shape === 'cube') {
        inputsDiv.innerHTML = `<label>Cạnh:</label><input id="a" type="number" /><br/>`;
      } else if (shape === 'sphere') {
        inputsDiv.innerHTML = `<label>Bán kính:</label><input id="r" type="number" /><br/>`;
      }
    }

    function draw() {
      const shape = document.getElementById('shape').value;
      const canvas = document.getElementById('canvas3d');
      if (!scene) {
        scene = new THREE.Scene();
        camera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
        renderer = new THREE.WebGLRenderer({ canvas });
        renderer.setSize(canvas.clientWidth, canvas.clientHeight);
        camera.position.z = 5;
      }
      if (mesh) scene.remove(mesh);

      let geometry;
      if (shape === 'cylinder') {
        const r = parseFloat(document.getElementById('r').value);
        const h = parseFloat(document.getElementById('h').value);
        geometry = new THREE.CylinderGeometry(r, r, h, 32);
      } else if (shape === 'cube') {
        const a = parseFloat(document.getElementById('a').value);
        geometry = new THREE.BoxGeometry(a, a, a);
      } else if (shape === 'sphere') {
        const r = parseFloat(document.getElementById('r').value);
        geometry = new THREE.SphereGeometry(r, 32, 32);
      }

      const material = new THREE.MeshNormalMaterial();
      mesh = new THREE.Mesh(geometry, material);
      scene.add(mesh);
      renderer.render(scene, camera);
    }

    function calculate() {
      const shape = document.getElementById('shape').value;
      let output = "";
      if (shape === 'cylinder') {
        const r = parseFloat(document.getElementById('r').value);
        const h = parseFloat(document.getElementById('h').value);
        const V = Math.PI * r * r * h;
        const S = 2 * Math.PI * r * (r + h);
        output = `Thể tích: ${V.toFixed(2)}<br>Diện tích: ${S.toFixed(2)}`;
      } else if (shape === 'cube') {
        const a = parseFloat(document.getElementById('a').value);
        const V = a ** 3;
        const S = 6 * a * a;
        output = `Thể tích: ${V.toFixed(2)}<br>Diện tích: ${S.toFixed(2)}`;
      } else if (shape === 'sphere') {
        const r = parseFloat(document.getElementById('r').value);
        const V = (4 / 3) * Math.PI * r ** 3;
        const S = 4 * Math.PI * r * r;
        output = `Thể tích: ${V.toFixed(2)}<br>Diện tích: ${S.toFixed(2)}`;
      }
      document.getElementById('output').innerHTML = output;
    }
  </script>
</body>
</html>

